{% extends 'hqwebapp/base_section.html' %}
{% load crispy_forms_tags %}
{% load i18n %}
{% load hq_shared_tags %}

{% requirejs_main "hqwebapp/js/widgets" %}

{% block page_content %}
  <p class="lead">
    {% blocktrans %}
      Enterprise Permissions
    {% endblocktrans %}
  </p>

  <p class="help-block">
    {% blocktrans %}
      Web users in the controlling project space will be automatically granted their same permissions
      in the rest of the enterprise. They will not appear as members of these other spaces. You may also
      exclude specific project spaces from enterprise permissions.
    {% endblocktrans %}
  </p>

  <p class="help-block">
    {% blocktrans %}
      To turn on enterprise permissions, select the controlling project space.
    {% endblocktrans %}
  </p>

  <form method="POST" action="{% url "update_enterprise_permissions_source_domain" domain %}">
    {% csrf_token %}
    <div class="row">
      <div class="col-sm-3">
        <select name="source_domain" class="hqwebapp-select2" data-allow-clear="true" data-placeholder="{% trans_html_attr "Select a Project Space" %}">
          {% for domain in all_domains %}
            <option{% if domain == source_domain %} selected{% endif %}>{{ domain }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="col-sm-3">
        <button class="btn btn-default" type="submit">
          {% trans "Update" %}
        </button>
      </div>
    </div>
  </form>

  {% if source_domain %}
    <br>
    <div class="row">
      <div class="col-sm-6">
        <p class="help-block">
          {% blocktrans %}
            Web users in <strong>{{ source_domain }}</strong> will also have permissions in the following project spaces.
          {% endblocktrans %}
        </p>
        {% include "enterprise/partials/enterprise_permissions_table.html" with DOMAINS=controlled_domains ACTION_ENABLE=False %}
      </div>
      <div class="col-sm-6">
        <p class="help-block">
          {% blocktrans %}
            Web users in <strong>{{ source_domain }}</strong> will <strong>not</strong> have permissions in the following project spaces.
          {% endblocktrans %}
        </p>
        {% include "enterprise/partials/enterprise_permissions_table.html" with DOMAINS=ignored_domains ACTION_ENABLE=True %}
      </div>
    </div>
  {% endif %}

{% endblock %}
